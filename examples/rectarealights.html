<!DOCTYPE html>
<html>
  <head>
    <title>RectAreaLights Demo</title>
    <link rel="stylesheet" href="styles.css" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
  </head>

  <body>
    <div id="app"></div>

    <three-game autorender>
      <three-scene id="scene">
        <!-- lights -->
        <three-rect-area-light
          id="light1"
          position="-5, 5, 5"
          color="red"
          intensity="5"
          width="4"
          height="10"
        ></three-rect-area-light>

        <three-rect-area-light
          id="light2"
          color="green"
          position="0, 5, 5"
          intensity="5"
          width="4"
          height="10"
        ></three-rect-area-light>

        <three-rect-area-light
          id="light3"
          color="blue"
          position="5, 5, 5"
          intensity="5"
          width="4"
          height="10"
        ></three-rect-area-light>

        <!-- torus knot -->
        <three-mesh
          id="knot"
          position.y="5"
          ontick="this.object.rotation.y = performance.now() / 1000"
        >
          <three-torus-knot-geometry args="[1.5, 0.5, 200, 16]"></three-torus-knot-geometry>
          <three-mesh-standard-material
            color="#fff"
            metalness="0"
            roughness="0"
          ></three-mesh-standard-material>
        </three-mesh>

        <!-- floor -->
        <three-mesh>
          <three-box-geometry args="[2000, 0.1, 2000]"></three-box-geometry>
          <three-mesh-standard-material
            color="#808080"
            metalness="0"
            roughness="0.1"
          ></three-mesh-standard-material>
        </three-mesh>

        <!-- orbit controls -->
        <three-orbit-controls id="controls"></three-orbit-controls>
      </three-scene>
    </three-game>

    <script type="module">
      import { RectAreaLightHelper } from "three/examples/jsm/helpers/RectAreaLightHelper"
      import { RectAreaLightUniformsLib } from "three/examples/jsm/lights/RectAreaLightUniformsLib"
      import "three-elements"

      queueMicrotask(() => {
        RectAreaLightUniformsLib.init()

        const scene = document.getElementById("scene")
        const controls = document.getElementById("controls")
        const knot = document.getElementById("knot")

        scene.camera.fov = 45
        scene.camera.position.set(0, 5, -15)

        controls.controls.target.copy(knot.object.position)
        controls.controls.update()

        scene.object.add(new RectAreaLightHelper(document.getElementById("light1").object))

        scene.object.add(new RectAreaLightHelper(document.getElementById("light2").object))

        scene.object.add(new RectAreaLightHelper(document.getElementById("light3").object))
      })
    </script>
  </body>
</html>
